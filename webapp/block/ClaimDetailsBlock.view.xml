<mvc:View xmlns:html="http://www.w3.org/1999/xhtml" xmlns:mvc="sap.ui.core.mvc" xmlns:core="sap.ui.core"
	xmlns="sap.m" xmlns:l="sap.ui.layout" xmlns:f="sap.ui.layout.form"
	controllerName="WarrantyClaim_MockUp.block.ClaimDetailsBlockController">
	<VBox class="sapUiSmallMargin">
		<f:SimpleForm id="ClaimDetail"
			objectBindings="{WarrantyClaim>/}"
			editable="true"
			layout="ResponsiveGridLayout"
			labelSpanL="4"
			labelSpanM="12"
			adjustLabelSpan="false"
			emptySpanL="0"
			emptySpanM="0"
			columnsL="2"
			columnsM="2">
		<f:content>
			<core:Title text="Failure Details"/>
			<Label id="FailureMeasure_label" text="Failure KM" required="true" labelFor="FailureMeasure"/>
			<Input 
				id="FailureMeasure" 
				type="Number"
				required="true"
				value="{WarrantyClaim>FailureMeasure/value}"	
				change="onFailureMeasureChanged"
				valueState="{= ${WarrantyClaim>FailureMeasure/valid} ? 'None':'Error'}"
				editable="{WarrantyClaim>CanEdit}"
			/>
			
			<Label id="DateOfFailure_label" text="Date of Failure" required="true" labelFor="DateOfFailure"/>
			<DatePicker 
				id="DateOfFailure" 
				required="true"
				change="onChangeDatePicker"
				displayFormat="medium" 
				dateValue="{WarrantyClaim>DateOfFailure}"
				editable="{WarrantyClaim>CanEdit}"
			/>
			
			<core:Title text="Repair Details"/>
			<Label id="RepairOrderNumber_label" text="Repair Order Number" required="true" labelFor="repairOrderNumber"/>
			<Input 
				id="RepairOrderNumber" 
				value="{WarrantyClaim>RepairOrderNumber/value}" 
				editable="{WarrantyClaim>CanEdit}"
				change="onRepairOrderNumberChanged"
				valueState="{= ${WarrantyClaim>RepairOrderNumber/valid} ? 'None':'Error'}"
			/>
			
			<Label id="DateOfRepair_label" text="Date of Repair" required="true" labelFor="DateOfRepair"/>
			<DatePicker 
				id="DateOfRepair" 
				displayFormat="medium" 
				required="true"
				dateValue="{WarrantyClaim>DateOfRepair/value}" 
				change="onDateOfRepairChanged"
				valueState="{= ${WarrantyClaim>DateOfRepair/valid} ? 'None':'Error'}"
				editable="{WarrantyClaim>CanEdit}"
				/>
			<core:Title text="Main Causal Part" />
			<Label text="MCPN" required="true" labelFor="MCPN"/>
			<Input 
				id="MCPN" 
				required="true"
				value="{WarrantyClaim>/Parts/0/PartNumber}"	
				editable="{WarrantyClaim>CanEdit}"
				description="{WarrantyClaim>/Parts/0/Description}"
				showValueHelp="true"
				showSuggestion="true"
				suggest="onPartSuggest"
				suggestionItemSelected="onPartSelected"
				suggestionRows="{/ZDPE_C_MATERIALS}"
				valueHelpRequest="addMCPN"
			>
				<suggestionColumns>
					<Column>
						<Text text="Part No." />
					</Column>
					<Column>
						<Text text="Description" />
					</Column>
				</suggestionColumns>
				<suggestionRows>
					<ColumnListItem>
						<cells>
							<Label text="{materialNo}" />
							<Label text="{description}" />
						</cells>
					</ColumnListItem>
				</suggestionRows>									
			</Input>
			<Label text="MCPN Quantity" required="true" labelFor="MCPNQuantity"/>
			<Input 
				id="MCPNQuantity" 
				type="Number"
				required="true"
				value="{
					path: 'WarrantyClaim>/Parts/0/Quantity',
					type: 'sap.ui.model.type.Float',
					formatOptions: {
						maxFractionDigits: 0
					}
				}"
				editable="{WarrantyClaim>CanEdit}"
			/>
			<core:Title text="MIL" />
			<Label text="MIL ON"/>
			<CheckBox id="MIL_ON" class="sapUiSmallMarginEnd" selected="{WarrantyClaim>MilIndicator}" select="onMILSelected" editable="{WarrantyClaim>CanEdit}"/>
			<Input 
				id="DTC1" 
				width="95%" 
				placeholder="{= ${WarrantyClaim>CanEdit} ? 'DTC1' : '' }" 
				value="{WarrantyClaim>DTC1}"
				visible="{= ${WarrantyClaim>MilIndicator}}" 
				editable="{WarrantyClaim>CanEdit}"
				valueState="{= ${WarrantyClaim>MilIndicator} &amp;&amp; ${WarrantyClaim>DTC1} === '' ? 'Error' : 'None' }"
				valueStateText="At least one DTC must be entered when MIL is selected"	
			/>
			<Input id="DTC2" width="95%" placeholder="{= ${WarrantyClaim>CanEdit} ? 'DTC2' : '' }" value="{WarrantyClaim>DTC2}" visible="{= ${WarrantyClaim>MilIndicator} === true }" editable="{WarrantyClaim>CanEdit}"/>
			<Input id="DTC3" placeholder="{= ${WarrantyClaim>CanEdit} ? 'DTC3' : '' }" value="{WarrantyClaim>DTC3}" visible="{= ${WarrantyClaim>MilIndicator} === true }" editable="{WarrantyClaim>CanEdit}"/>
			<core:Title text="Staff" />
			<Label 
				id="Technician_label" 
				labelFor="Technician" 
				text="Technician" 
				required="{= ${WarrantyClaim>ClaimTypeGroup} !== 'RECALL' }"
			/>	
			<ComboBox
				id="Technician"
				width="100%"
				showSecondaryValues= "true"
				required="{= ${WarrantyClaim>ClaimTypeGroup} !== 'RECALL' }"
				enabled="{= ${WarrantyClaim>ClaimTypeGroup} !== 'RECALL' }"
				editable="{WarrantyClaim>CanEdit}"
				items="{
					path: '/EmployeeSet',
					sorter: { path: 'LastName' },
					filters : [
						{ path : 'Relationship', operator : 'EQ', value1 : 'Technician'}
					]
				}"
				selectedKey="{WarrantyClaim>Technician/value}"
				selectionChange="onTechnicianChanged"
				valueState="{= ${WarrantyClaim>Technician/valid} ? 'None':'Error'}"
			>
				<core:ListItem key="{EmployeeNumber}" text="{FirstName} {LastName}" additionalText = "({EmployeeNumber})"/>
			</ComboBox>	
			<Label 
				id="ServiceAdvisor_label" 
				labelFor="ServiceAdvsior" 
				text="Service Advisor" 
				required="{= ${WarrantyClaim>ClaimTypeGroup} !== 'RECALL' }"
			/>
			<ComboBox
				id="ServiceAdvisor"
				width="100%"
				showSecondaryValues= "true"
				required="{= ${WarrantyClaim>ClaimTypeGroup} !== 'RECALL' }"
				enabled="{= ${WarrantyClaim>ClaimTypeGroup} !== 'RECALL' }"
				editable="{WarrantyClaim>CanEdit}"
				items="{
					path: '/EmployeeSet',
					sorter: { path: 'LastName' },
					filters : [
						{ path : 'Relationship', operator : 'EQ', value1 : 'Service Advisor'}
					]					
				}"
				selectedKey="{WarrantyClaim>ServiceAdvisor/value}"
				selectionChange="onServiceAdvisorChanged"
				valueState="{= ${WarrantyClaim>ServiceAdvisor/valid} ? 'None':'Error'}"
			>
				<core:ListItem key="{EmployeeNumber}" text="{FirstName} {LastName}" additionalText = "({EmployeeNumber})"/>
			</ComboBox>	
		</f:content>
		</f:SimpleForm>
		<f:SimpleForm id="ClaimSerial"
			objectBindings="{WarrantyClaim>/}"
			editable="true"
			layout="ResponsiveGridLayout"
			labelSpanL="2"
			labelSpanM="12"
			adjustLabelSpan="false"
			emptySpanL="2"
			emptySpanM="0"
			columnsL="1"
			columnsM="2"
			singleContainerFullSize="false"
		>
			<f:content>
				<core:Title text="Recall Serial Numbers" />
				<Label text="Serial Numbers" required="{= ${WarrantyClaim>ClaimTypeGroup} === 'RECALL' &amp;&amp; ${ViewHelper>/warrantyUI/serialNumberIsMandatory}}"/>
				<Input 
					id="OldSerialNumber" 
					placeholder="Old Serial Number" 
					value="{WarrantyClaim>OldSerialNumber/value}" 
					editable="{WarrantyClaim>CanEdit}" 
					enabled="{= ${WarrantyClaim>ClaimTypeGroup} === 'RECALL'}"
					change="onOldSerialNumberChanged"
					valueState="{= ${WarrantyClaim>OldSerialNumber/valid} ? 'None':'Error'}"
				/>
				<Input 
					id="NewSerialNumber" 
					placeholder="New Serial Number" 
					value="{WarrantyClaim>NewSerialNumber/value}" 
					editable="{WarrantyClaim>CanEdit}" 
					enabled="{= ${WarrantyClaim>ClaimTypeGroup} === 'RECALL'}"	
					change="onNewSerialNumberChanged"
					valueState="{= ${WarrantyClaim>NewSerialNumber/valid} ? 'None':'Error'}"
				/>
			</f:content>
		</f:SimpleForm>
		<f:SimpleForm id="ClaimParts"
			objectBindings="{WarrantyClaim>/}"
			editable="true"
			layout="ResponsiveGridLayout"
			labelSpanL="4"
			labelSpanM="12"
			adjustLabelSpan="false"
			emptySpanL="0"
			emptySpanM="0"
			columnsL="2"
			columnsM="2"
			singleContainerFullSize="false">
			<f:content>
				<core:Title text="Parts" />
				<Label 
					id="PartsInstallDate_label"
					text="Install Date" 
					labelFor="PartsInstallDate"
					required="{= ${WarrantyClaim>ClaimTypeGroup} === 'PARTS' }"
				/>
				<DatePicker 
					id="PartsInstallDate" 
					displayFormat="medium" 
					dateValue="{WarrantyClaim>PartsInstallDate/value}" 
					editable="{WarrantyClaim>CanEdit}"
					required="{= ${WarrantyClaim>ClaimTypeGroup} === 'PARTS' }"
					enabled="{= ${WarrantyClaim>ClaimTypeGroup} === 'PARTS' }"
					change="onPartsInstallDateChanged"
					valueState="{= ${WarrantyClaim>PartsInstallDate/valid} ? 'None':'Error'}"
				/>
				<Label 
					id="PartsInstallKM_label"
					text="Part Install KM" 
					labelFor="PartsInstallKM" 
					required="{= ${WarrantyClaim>ClaimTypeGroup} === 'PARTS' }"
				/>
				<Input 
					id="PartsInstallKM" 
					type="Number"
					value="{WarrantyClaim>PartsInstallKm/value}"
					editable="{WarrantyClaim>CanEdit}" 
					required="{= ${WarrantyClaim>ClaimTypeGroup} === 'PARTS' }"
					enabled="{= ${WarrantyClaim>ClaimTypeGroup} === 'PARTS' }"
					change="onPartsInstallKmChanged"
					valueState="{= ${WarrantyClaim>PartsInstallKm/valid} ? 'None':'Error'}"
				/>
				<Label 
					id="OriginalInvoiceNumber_label"
					text="Original Invoice Number" 
					labelFor="originalInvoiceNo" 
					required="{= ${WarrantyClaim>ClaimTypeGroup} === 'PARTS' }"
					enabled="{= ${WarrantyClaim>ClaimTypeGroup} === 'PARTS' }"
				/>
				<Input 
					id="OriginalInvoiceNumber" 
					value="{WarrantyClaim>OriginalInvoiceNumber/value}" 
					editable="{WarrantyClaim>CanEdit}" 
					required="{= ${WarrantyClaim>ClaimTypeGroup} === 'PARTS' }"
					enabled="{= ${WarrantyClaim>ClaimTypeGroup} === 'PARTS' }"
					change="onOriginalInvoiceNumberChanged"
					valueState="{= ${WarrantyClaim>OriginalInvoiceNumber/valid} ? 'None':'Error'}"
				/>
			</f:content>
		</f:SimpleForm>
	</VBox>
</mvc:View>