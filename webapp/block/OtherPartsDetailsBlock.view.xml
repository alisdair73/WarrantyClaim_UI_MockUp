<mvc:View xmlns:html="http://www.w3.org/1999/xhtml" 
	xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m" xmlns:core="sap.ui.core"
	xmlns:f="sap.ui.layout.form" 
	xmlns:l="sap.ui.layout" controllerName="WarrantyClaim_MockUp.block.OtherPartsDetailsBlockController"
>
	<VBox class="sapUiSmallMargin">
		<f:SimpleForm id="MCPNForm"
			editable="true"
			layout="ResponsiveGridLayout"
			labelSpanL="2"
			labelSpanM="12"
			adjustLabelSpan="false"
			emptySpanL="0"
			emptySpanM="0"
			columnsL="1"
			columnsM="2"
		>
			<f:content>
				<core:Title text="Main Causal Part" />
				<Label text="MCPN" required="true" labelFor="MCPN"/>
		        <Input 
		          id="MCPN" 
		          required="true"
		          value="{MCPNHelper>/MCPN}"  
		          description="{MCPNHelper>/Description}"
		          change="onMCPNChanged"
		          editable="{= ${WarrantyClaim>/CanEdit} &amp;&amp; ${WarrantyClaim>/ClaimTypeGroup} !== 'RECALL'}"
		          showValueHelp="true"
		          showSuggestion="true"
		          filterSuggests="false"
		          suggest="onPartSuggest"
		          suggestionItemSelected="onPartSelected"
		          suggestionRows="{/ZDPE_C_MATERIALS}"
		          valueHelpRequest="addMCPN"
		        >
		          <layoutData>
		            <l:GridData span="L6" />
		          </layoutData>
		          <suggestionColumns>
		            <Column>
		              <Text text="Part No." />
		            </Column>
		            <Column>
		              <Text text="Description" />
		            </Column>
		          </suggestionColumns>
		          <suggestionRows>
		            <ColumnListItem>
		              <cells>
		                <Label text="{materialNo}" />
		                <Label text="{description}" />
		              </cells>
		            </ColumnListItem>
		          </suggestionRows>                 
		        </Input>
				<Label text="Quantity" required="true" labelFor="MCPNQuantity"/>
				<Input 
					id="MCPNQuantity" 
					type="Number"
					required="true"
					change="onMCPNChanged"
					value="{
						path: 'MCPNHelper>/Quantity',
						type: 'sap.ui.model.type.Float',
						formatOptions: {
							maxFractionDigits: 0
						}
					}"
					editable="{= ${WarrantyClaim>/CanEdit} &amp;&amp; ${WarrantyClaim>/ClaimTypeGroup} !== 'RECALL'}"
				>
					<layoutData>
						<l:GridData span="L2" />
					</layoutData>
				</Input>
			</f:content>
		</f:SimpleForm>	
	</VBox>

	<Table 
		items="{WarrantyClaim>/Parts}"
		id="partsTable" 
	>
		<headerToolbar>
			<Toolbar>
				<Title text="Other Parts" level="H2"/>
				<ToolbarSpacer/>
				<Button 
					text="Add parts" 
					icon="sap-icon://add" 
					press="addPart" 
					visible="{= ${WarrantyClaim>/CanEdit} &amp;&amp; ${WarrantyClaim>/ClaimTypeGroup} !== 'RECALL'}"
				/>
			</Toolbar>
		</headerToolbar>
	    <items>
	        <ColumnListItem vAlign="Middle">
	            <cells>
	            	<Text text="{WarrantyClaim>PartNumber}"/>
	                <Text text="{WarrantyClaim>Description}"/>
	                <l:HorizontalLayout>
	                	<Text 
	                		text="{
	                			path: 'WarrantyClaim>Quantity',							
	                			type: 'sap.ui.model.type.Float',
								formatOptions: {
									minFractionDigits: 3,
									maxFractionDigits: 3
								}
							}" 
							visible= "{= ${WarrantyClaim>isMCPN} || !${WarrantyClaim>/CanEdit}}"
						/>
	                	<Input
	                		type="Number"
	                		value="{
								path: 'WarrantyClaim>Quantity',
								type: 'sap.ui.model.type.Float',
								formatOptions: {
									minFractionDigits: 3,
									maxFractionDigits: 3
								}
							}" 
							editable="{= ${WarrantyClaim>/CanEdit} &amp;&amp; ${WarrantyClaim>/ClaimTypeGroup} !== 'RECALL'}"
	                		visible="{= !${WarrantyClaim>isMCPN} &amp;&amp; ${WarrantyClaim>/CanEdit}}"
	            		/>
	        		</l:HorizontalLayout>
					<ComboBox
						width="100%"
						editable="{= ${WarrantyClaim>/CanEdit} &amp;&amp; ${WarrantyClaim>/ClaimTypeGroup} !== 'RECALL'}"
						items="{path:'/PartStatusSet', templateShareable:false}"
						selectedKey="{WarrantyClaim>PartRequested}"
					>
						<core:ListItem 
							key="{StatusCode}" 
							text="{Description}" 
							enabled="{= ${StatusCode} === '2' || ${StatusCode} === '3' || ${StatusCode} === '4'}"
						/>
					</ComboBox>	
	                <l:HorizontalLayout>
	                	<Button 
	                		icon="sap-icon://delete" 
	                		press="deletePart" 
	                		visible="{= ${WarrantyClaim>/CanEdit} &amp;&amp; !${WarrantyClaim>IsMCPN} &amp;&amp; ${WarrantyClaim>/ClaimTypeGroup} !== 'RECALL'}"
	                	/>
	                </l:HorizontalLayout>
	            </cells>
	        </ColumnListItem>
	    </items>		
	    <columns>
	        <Column >
	            <header>
	                <Label text="Part No."/>
	            </header>
	        </Column>
	        <Column  >
	            <header>
	                <Label text="Description"/>
	            </header>
	        </Column>
	        <Column  width="10em">
	            <header>
	                <Label text="Qty"/>
	            </header>
	        </Column>
	        <Column >
	            <header>
	                <Label text="Part Status"/>
	            </header>
	        </Column>
	     	<Column width="7em" hAlign="End"/>
	     </columns>
	 </Table>
</mvc:View>